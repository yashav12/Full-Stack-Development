<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Train Reservation — Typing Output</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg-1: #0f172a;
      --bg-2: #071029;
      --accent: #7c5cff;
      --accent-2: #00d4ff;
      --glass: rgba(255,255,255,0.06);
      --muted: rgba(255,255,255,0.75);
      --glass-border: rgba(255,255,255,0.08);
      --glass-blur: 10px;
      --btn-padding: 0.55rem 0.9rem;
      --radius: 14px;
      --shadow: 0 8px 30px rgba(2,6,23,0.6);
      --entrance-distance: 14px;
      --entrance-duration: 640ms;
      --entrance-ease: cubic-bezier(.16,.9,.3,1);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color: #e6eef8;
      background: radial-gradient(1200px 800px at 10% 10%, rgba(124,92,255,0.12), transparent 6%),
                  radial-gradient(1000px 700px at 90% 90%, rgba(0,212,255,0.06), transparent 8%),
                  linear-gradient(180deg, var(--bg-1), var(--bg-2));
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:36px;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
    }

    /* soft animated sheen behind the page */
    body::before{
      content:"";
      position:fixed;
      inset:-30%;
      background: conic-gradient(from 220deg at 50% 50%, rgba(124,92,255,0.08), rgba(0,212,255,0.06), rgba(124,92,255,0.06));
      filter: blur(80px) saturate(1.1);
      opacity:0.9;
      z-index:0;
      transform: rotate(0deg);
      animation: spin 30s linear infinite;
      pointer-events:none;
    }
    @keyframes spin{ to { transform: rotate(360deg); } }

    .container {
      width:100%;
      max-width:980px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow);
      backdrop-filter: blur(var(--glass-blur)) saturate(1.1);
      padding:22px;
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:20px;
      align-items:start;
      overflow:visible;
    }

    /* entrance animation base state (all elements we animate use .animate) */
    .animate {
      opacity: 0;
      transform: translateY(var(--entrance-distance)) scale(0.995);
      will-change: transform, opacity;
    }

    @keyframes fadeUp {
      from {
        opacity: 0;
        transform: translateY(var(--entrance-distance)) scale(0.995);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .animate.is-visible {
      animation: fadeUp var(--entrance-duration) var(--entrance-ease) both;
    }

    /* layout + header */
    h1 { margin:0 0 8px 0; font-size:1.6rem; color: white; text-shadow: 0 2px 18px rgba(124,92,255,0.12); }
    p.lead { margin:0 0 14px 0; color:#cfe9ff; opacity:0.9; }

    .col { padding:12px; }
    .grid { gap:14px; display:flex; flex-wrap:wrap; align-items:flex-start; }

    button {
      --bpad: var(--btn-padding);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.06);
      color: white;
      padding: var(--bpad);
      border-radius: 12px;
      cursor:pointer;
      font-weight:600;
      letter-spacing:0.02em;
      box-shadow: 0 6px 18px rgba(2,6,23,0.45), inset 0 -2px 6px rgba(0,0,0,0.18);
      transition: transform .18s ease, box-shadow .18s ease, opacity .18s ease;
      margin:6px 8px 6px 0;
      position:relative;
      overflow:hidden;
    }
    button:hover { transform: translateY(-4px); box-shadow: 0 18px 40px rgba(2,6,23,0.6); }
    button:active { transform:translateY(-2px) scale(.997); }

    button#btnRunAll{
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      border: none; color: white;
      box-shadow: 0 10px 30px rgba(124,92,255,0.25), 0 6px 12px rgba(0,212,255,0.06);
    }
    button::after{
      content:""; position:absolute; left:0; bottom:0; height:3px; width:0%;
      background: linear-gradient(90deg, rgba(255,255,255,0.12), rgba(255,255,255,0.02));
      transition: width .28s cubic-bezier(.2,.9,.2,1);
    }
    button:hover::after{ width:100%; }

    /* ---------------------------
       HACKER / TERMINAL style for result
       Typing behavior: no scrolling (overflow hidden), inner spans for content + caret
       --------------------------- */

    pre#out {
      margin: 0;
      border-radius: 12px;
      padding: 18px;
      min-height: 220px;
      height: 220px;          /* fixed height so layout doesn't jump */
      position: relative;
      z-index: 2;
      background:
        radial-gradient(ellipse at 15% 10%, rgba(0,255,120,0.02), transparent 8%),
        linear-gradient(180deg, #00140a 0%, #001b0d 60%, #002217 100%);
      color: #7CFF7C; /* neon green text */
      border: 1px solid rgba(0,255,120,0.06);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.02), 0 10px 30px rgba(0,0,0,0.7);
      font-family: "Courier New", ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      font-size: 0.95rem;
      line-height: 1.45;
      overflow: hidden;      /* remove scrolling */
      white-space: pre-wrap; /* preserve newlines */
      word-break: break-word;
      background-image:
        repeating-linear-gradient(transparent, transparent 2px, rgba(0,255,120,0.015) 2px, rgba(0,255,120,0.015) 3px),
        radial-gradient(ellipse at 15% 10%, rgba(0,255,120,0.02), transparent 8%),
        linear-gradient(180deg, #00140a 0%, #001b0d 60%, #002217 100%);
      background-blend-mode: overlay, normal, normal;
      text-shadow: 0 0 6px rgba(124,255,124,0.08), 0 0 18px rgba(0,255,120,0.02);
      outline: none;
    }

    /* the content area inside the pre, and the caret span */
    #outContent { display:inline-block; vertical-align:top; }
    #caret {
      display:inline-block;
      vertical-align:top;
      margin-left:4px;
      color:#66ff66;
      font-weight:700;
      opacity:0.95;
      transform: translateY(0.04em);
      filter: drop-shadow(0 0 6px rgba(102,255,102,0.07));
      will-change: opacity;
      /* blinking animation */
      animation: blinkCaret 1s steps(2,end) infinite;
    }
    @keyframes blinkCaret {
      0%,49% { opacity:0.95; }
      50%,100% { opacity:0.05; }
    }

    /* decorative scanline & noise, behind the text */
    pre#out::before{
      content: "";
      position: absolute;
      left: -10%;
      top: -40%;
      width: 120%;
      height: 200%;
      pointer-events: none;
      border-radius: inherit;
      background: linear-gradient(180deg, rgba(255,255,255,0.00) 0%, rgba(0,255,120,0.04) 45%, rgba(0,255,120,0.06) 50%, rgba(0,255,120,0.04) 55%, rgba(255,255,255,0.00) 100%);
      mix-blend-mode: overlay;
      transform: translateY(-120%);
      opacity: 0.12;
      filter: blur(6px) saturate(1.2);
      animation: scanline 6s linear infinite;
    }
    pre#out::after{
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      border-radius: inherit;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(255,255,255,0.01) 0, transparent 6%),
        radial-gradient(circle at 70% 70%, rgba(255,255,255,0.007) 0, transparent 8%);
      mix-blend-mode: soft-light;
      opacity: 0.6;
    }
    @keyframes scanline {
      0%   { transform: translateY(-120%); opacity: 0.14; }
      50%  { transform: translateY(0%);    opacity: 0.18; }
      100% { transform: translateY(120%);  opacity: 0.14; }
    }

    /* when output is empty show a subtle hint caret to the right */
    pre#out.empty #outContent::after{
      content: "_";
      color: #66ff66;
      margin-left: 6px;
      opacity: 0.9;
      animation: blinkCaret 1s steps(2,end) infinite;
    }

    .col.right { padding:18px; display:flex; flex-direction:column; gap:12px; justify-content:flex-start; }
    .card { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:12px; padding:12px; border:1px solid rgba(255,255,255,0.03); box-shadow:0 6px 20px rgba(2,6,23,0.45); }
    .badge { display:inline-block; font-size:0.8rem; padding:6px 10px; border-radius:999px; background: rgba(255,255,255,0.025); border:1px solid rgba(255,255,255,0.03); color:#eaf6ff; margin-right:8px; }

    @media (max-width:920px){ .container { grid-template-columns: 1fr; padding:16px; } .col.right { order: -1; } }

    /* prefers reduced motion — set outputs instantly and halt animations */
    @media (prefers-reduced-motion: reduce){
      body::before, button, button::after, pre#out::before, pre#out::after { animation: none; transition: none; }
      .animate { opacity:1 !important; transform:none !important; }
      #caret { animation: none; opacity:0; } /* hide caret for reduced motion */
    }
  </style>
</head>
<body>

  <div class="container animate" role="main" aria-label="Train reservation demo container">
    <div class="col animate">
      <h1>Train Reservation — Array Methods</h1>
      <p class="lead">Click the buttons to run array-method tasks. Output appears below as a typing animation.</p>

      <div class="grid" aria-hidden="false">
        <button id="btnList" class="animate" title="Show passenger list">1. Passenger List</button>
        <button id="btnSenior" class="animate" title="Show senior citizens (60+)">2. Senior Citizens (60+)</button>
        <button id="btnUpper" class="animate" title="Convert names to uppercase">3. Uppercase Names</button>
        <button id="btnTotal" class="animate" title="Sum of ages (reduce)">4. Total Age (reduce)</button>
        <button id="btnTotalRight" class="animate" title="Sum of ages (reduceRight)">5. Total Age (reduceRight)</button>
        <button id="btnAdults" class="animate" title="Check if all are adults">6. Check All Adults</button>
        <button id="btnMinors" class="animate" title="Check if any minor exists">7. Any Minor?</button>
        <button id="btnSeatsConvert" class="animate" title="Convert seat string to array">8. Convert Seat String</button>
        <button id="btnAdd" class="animate" title="Add extra passengers">9. Add Extra Passengers</button>
        <button id="btnSeparate" class="animate" title="Separate first passenger">10. Separate First</button>
        <button id="btnRunAll" class="animate" title="Run all tasks">Run All</button>
      </div>
    </div>

    <div class="col right animate">
      <div class="card animate" aria-live="polite">
        <h3 style="margin:0 0 8px 0;">Result</h3>
        <!-- inner spans: outContent receives typed text; caret shown separately -->
        <pre id="out" class="empty" tabindex="0" aria-label="Output">
<span id="outContent">(Nothing yet)</span><span id="caret" aria-hidden="true">_</span>
        </pre>
        <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap;">
          <span class="badge">Arrays only</span>
          <span class="badge">Events & functions</span>
          <span class="badge">No objects</span>
        </div>
      </div>
    </div>
  </div>

  <script>
    /*************************************************************************
     * Entrance animation: add 'is-visible' to each .animate element in a
     * staggered fashion on DOMContentLoaded.
     *************************************************************************/
    document.addEventListener('DOMContentLoaded', function () {
      try {
        const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        const nodes = Array.from(document.querySelectorAll('.animate'));
        const startDelay = prefersReduced ? 0 : 80; // ms
        const stagger = prefersReduced ? 0 : 90; // ms per element
        nodes.forEach((el, idx) => {
          const delay = startDelay + idx * stagger;
          setTimeout(() => el.classList.add('is-visible'), delay);
        });
      } catch (e) { console.warn('Entrance animation failed:', e); }
    });

    /*************************************************************************
     * Train-reservation logic (arrays only)
     * Typing engine: typeText(...) - cancels previous typing when a new call starts
     *************************************************************************/
    let names  = ['Asha', 'Ramesh', 'Vikram', 'Geeta', 'Sundar', 'Kavita'];
    let ages   = [25,      67,       15,       34,      61,       17];
    let seats  = [12,      3,        45,       22,      14,       33];
    let genders= ['F',     'M',      'M',      'F',     'M',      'F'];

    const out = document.getElementById('out');
    const outContent = document.getElementById('outContent');
    const caret = document.getElementById('caret');

    // Typing controller for cancellation
    let typingToken = 0;

    // Detect reduced motion preference
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    // typeText: animates typing of `text` into outContent; returns a Promise that resolves when done.
    function typeText(text, options = {}) {
      // options: { speedMin, speedMax } ms per character (randomized)
      const speedMin = options.speedMin ?? 18;
      const speedMax = options.speedMax ?? 42;

      // cancel any ongoing typing
      typingToken++;
      const thisToken = typingToken;

      // normalize text
      const normalized = text == null ? '' : String(text);
      if (normalized.trim() === '') {
        out.classList.add('empty');
        outContent.textContent = '(Nothing yet)';
        caret.style.opacity = prefersReduced ? 0 : 0.95;
        return Promise.resolve();
      }

      out.classList.remove('empty');
      outContent.textContent = '';
      caret.style.opacity = prefersReduced ? 0 : 0.95;

      if (prefersReduced) {
        // If user requested reduced motion — display instantly
        outContent.textContent = normalized;
        caret.style.opacity = 0; // hide caret for reduced motion
        return Promise.resolve();
      }

      return new Promise(resolve => {
        let idx = 0;

        // helper to compute jittered delay for realistic typing
        function nextDelay() {
          return Math.floor(speedMin + Math.random() * (speedMax - speedMin));
        }

        function step() {
          // cancelled?
          if (typingToken !== thisToken) {
            // stop quietly
            return resolve();
          }

          if (idx >= normalized.length) {
            // finished typing
            // keep caret blinking for a short time, then hide after 700ms
            setTimeout(() => {
              if (typingToken === thisToken) caret.style.opacity = 0.55;
              // resolve regardless
              resolve();
            }, 300);
            return;
          }

          // append next character
          outContent.textContent += normalized[idx++];
          // ensure caret stays visible while typing
          caret.style.opacity = 0.95;

          // schedule next char
          setTimeout(step, nextDelay());
        }

        // start
        setTimeout(step, nextDelay());
      });
    }

    // Centralized print function using typeText
    function print(msg) {
      // If msg is array or multi-line, coerce to a single string preserving newlines
      let text;
      if (Array.isArray(msg)) text = msg.join('\n');
      else text = String(msg);
      // Kick off typing (cancels previous)
      typeText(text);
    }

    /* -- Tasks (same logic as before) -- */

    function passengerList(){
      if(names.length === 0){ print('No passengers.'); return; }
      const lines = [];
      names.forEach((name, i) => {
        const age = ages[i]   !== undefined ? ages[i]   : '-';
        const seat= seats[i]  !== undefined ? seats[i]  : '-';
        const gen = genders[i]!== undefined ? genders[i] : '-';
        lines.push(`Passenger: ${name} | Age: ${age} | Seat: ${seat} | Gender: ${gen}`);
      });
      print(lines.join('\n'));
    }

    function seniorCitizens(){
      const seniorIndexes = ages.map((age, i) => ({i, age})).filter(p => p.age >= 60).map(p => p.i);
      if(seniorIndexes.length === 0){ print('No senior citizens (60+).'); return; }
      const lines = seniorIndexes.map(i => `${names[i]} | Age: ${ages[i]} | Seat: ${seats[i] ?? '-'} | Gender: ${genders[i] ?? '-'}`);
      print('Senior citizens (60+):\n' + lines.join('\n'));
    }

    function uppercaseNames(){
      names = names.map(n => n.toUpperCase());
      print('Names converted to uppercase:\n' + names.join(', '));
    }

    function totalAgeReduce(){
      if(ages.length === 0){ print('No ages available.'); return; }
      const total = ages.reduce((acc, val) => acc + val, 0);
      print(`Total age (reduce left→right): ${total}`);
    }

    function totalAgeReduceRight(){
      if(ages.length === 0){ print('No ages available.'); return; }
      const total = ages.reduceRight((acc, val) => acc + val, 0);
      print(`Total age (reduceRight right→left): ${total}`);
    }

    function checkAllAdults(){
      if(ages.length === 0){ print('No passengers.'); return; }
      const allAdults = ages.every(a => a >= 18);
      print(`All passengers are adults (age >= 18)? ${allAdults}`);
    }

    function checkAnyMinor(){
      if(ages.length === 0){ print('No passengers.'); return; }
      const hasMinor = ages.some(a => a < 18);
      print(`Is there at least one minor (age < 18)? ${hasMinor}`);
    }

    function convertSeatString(){
      const seatStr = '12,13,14,15';
      const converted = Array.from(seatStr.split(','), s => Number(s));
      print(`Converted seats from string "${seatStr}" → [${converted.join(', ')}]`);
    }

    function addExtraPassengers(){
      const extras = ['Rahul', 'Sita'];
      names = [...names, ...extras];
      print(`Added extra passengers ${extras.join(', ')}. Names now:\n${names.join(', ')}`);
    }

    function separateFirstPassenger(){
      if(names.length === 0){ print('No passengers.'); return; }
      const [first, ...restPassengers] = names;
      print(`First passenger: ${first}\nRemaining passengers: ${restPassengers.join(', ') || '-'}`);
    }

    function runAll(){
      const messages = [];
      const lines1 = [];
      names.forEach((name, i) => {
        const age = ages[i]   !== undefined ? ages[i]   : '-';
        const seat= seats[i]  !== undefined ? seats[i]  : '-';
        const gen = genders[i]!== undefined ? genders[i] : '-';
        lines1.push(`Passenger: ${name} | Age: ${age} | Seat: ${seat} | Gender: ${gen}`);
      });
      messages.push('1) Passenger List:\n' + (lines1.length ? lines1.join('\n') : 'No passengers.'));

      const seniorIdx = ages.map((a,i)=>({i,a})).filter(p=>p.a>=60).map(p=>p.i);
      messages.push('2) Senior Citizens (60+):\n' + (seniorIdx.length ? seniorIdx.map(i=>`${names[i]} | Age: ${ages[i]}`).join('\n') : 'None'));

      messages.push('3) Uppercase Names (preview):\n' + names.map(n => n.toUpperCase()).join(', '));
      messages.push('4) Total Age (reduce): ' + (ages.reduce((a,b)=>a+b,0)));
      messages.push('5) Total Age (reduceRight): ' + (ages.reduceRight((a,b)=>a+b,0)));
      messages.push('6) All adults (>=18)? ' + (ages.every(a=>a>=18)));
      messages.push('7) Any minor (<18)? ' + (ages.some(a=>a<18)));
      const seatStr = '12,13,14,15';
      const converted = Array.from(seatStr.split(','), s => Number(s));
      messages.push('8) Converted seats from string: [' + converted.join(', ') + ']');
      messages.push('9) Add extras using spread: add Rahul,Sita → ' + [...names, 'Rahul', 'Sita'].join(', '));
      const [first, ...restP] = names;
      messages.push('10) Separate first: ' + first + ' | Remaining count: ' + restP.length);

      // join with double newlines for readability — typeText will handle it
      print(messages.join('\n\n'));
    }

    // Attach events
    document.getElementById('btnList').addEventListener('click', passengerList);
    document.getElementById('btnSenior').addEventListener('click', seniorCitizens);
    document.getElementById('btnUpper').addEventListener('click', uppercaseNames);
    document.getElementById('btnTotal').addEventListener('click', totalAgeReduce);
    document.getElementById('btnTotalRight').addEventListener('click', totalAgeReduceRight);
    document.getElementById('btnAdults').addEventListener('click', checkAllAdults);
    document.getElementById('btnMinors').addEventListener('click', checkAnyMinor);
    document.getElementById('btnSeatsConvert').addEventListener('click', convertSeatString);
    document.getElementById('btnAdd').addEventListener('click', addExtraPassengers);
    document.getElementById('btnSeparate').addEventListener('click', separateFirstPassenger);
    document.getElementById('btnRunAll').addEventListener('click', runAll);

    // initial print
    passengerList();
  </script>
</body>
</html>
